---
title: '2020-07-15'
author: "Gigi"
date: "7/15/2020"
output: html_document
---

```{r}
library(deSolve)
library(ggplot2)

############# Model Equations ######################

my_model <- function(times,yinit,pars){
	
	with(as.list(c(yinit,pars)), {
	
		dM <- B-(omega+mu)*M
		dS0 <- omega*M-lambda*S0-mu*S0
		dI1 <- lambda*S0- gamma1*I1-mu*I1
		dS1 <- gamma1*I1-sigma1*lambda*S1-mu*S1
		dI2 <- sigma1*lambda*S1- gamma2*I2-mu*I2
		dS2 <- gamma2*I2- sigma2*lambda*S2-mu*S2
		dI3 <- sigma2*lambda*S2-gamma3*I3-mu*I3
		dS3 <- gamma3*I3-sigma3*lambda*S3+gamma4*I4-mu*S3
		dI4 <- sigma3*lambda*S3-gamma4*I4-mu*I4

	return(list(c(dM,dS0, dI1,dS1, dI2,dS2, dI3,dS3, dI4)))})
	}

################## Setting Parameters ##################

lambda=2.3
gamma1=1.1
gamma2=1.2
gamma3=1.3
gamma4=1.4
omega=0.8
mu=0.001
B=2
sigma1=0.9
sigma2=0.8
sigma3=0.7

my_pars <- cbind(B,omega,mu,lambda, gamma1,sigma1,gamma2,sigma2,gamma3,sigma3,gamma4)

############### Setting Time Frame ####################

start_time = 0 # start date (years)
end_time = 25 # end date (years)
my_times <- seq(start_time, end_time, by = 0.25) # gives a sequence from start to end
											 # in increments of 1

############ Setting Initial Conditions ###############

# initial starting values
my_yinit <- c(M=200,S0 = 10000, I1 = 1,S1=1,I2=1,S2=1,I3=1,S3=1,I4=1)

############# Running The Model ####################

results <- as.data.frame(ode(y=my_yinit, times=my_times, func=my_model,
	parms=my_pars, method='lsoda'))

############ Plotting Results ########################

colors <- c('S1'='black','I2'='red')
ggplot(data=results) + geom_line(aes(x=time,y=S1,col='Susceptible')) + 
	geom_line(aes(x=time,y=I2,col='Infected')) + 
	scale_colour_manual(name="Legend",values=colors) +
	xlab('Year') + ylab('Number of People') + theme_classic()
```

